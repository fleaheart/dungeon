<!doctype html>
<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

    <title>マップ</title>

    <style type="text/css">

    .map {
        border: solid 2px black;
        padding: 0px;
        background-color: lightgrey;
        vertical-align: top;

    }

    .kukaku {
        display: inline-block;
        padding: 0px;
        margin: 0px;
        width: 40px;
        height: 40px;
        background-color: white;
        vertical-align: top;
        text-align: center;
    }

    .box0, .box1, .box2, .box3, .box4, .box5, .box6, .box7,
    .box8, .box9, .boxA, .boxB, .boxC, .boxD, .boxE, .boxF {
        display: inline-block;
        margin: 0px;
        padding: 0px;
        width: 36px;
        height: 36px;
        vertical-align: middle;
        text-align: center;
        border : solid 0px black;
        background-color: white;
    }

    .box0 {
        margin: 2px 2px 2px 2px;
        border-width: 0px 0px 0px 0px;
    }
    .box1 {
        margin: 0px 2px 2px 2px;
        border-width: 2px 0px 0px 0px;
    }
    .box2 {
        margin: 2px 0px 2px 2px;
        border-width: 0px 2px 0px 0px;
    }
    .box3 {
        margin: 0px 0px 2px 2px;
        border-width: 2px 2px 0px 0px;
    }
    .box4 {
        margin: 2px 2px 0px 2px;
        border-width: 0px 0px 2px 0px;
    }
    .box5 {
        margin: 0px 2px 0px 2px;
        border-width: 2px 0px 2px 0px;
    }
    .box6 {
        margin: 2px 0px 0px 2px;
        border-width: 0px 2px 2px 0px;
    }
    .box7 {
        margin: 0px 0px 0px 2px;
        border-width: 2px 2px 2px 0px;
    }
    .box8 {
        margin: 2px 2px 2px 0px;
        border-width: 0px 0px 0px 2px;
    }
    .box9 {
        margin: 0px 2px 2px 0px;
        border-width: 2px 0px 0px 2px;
    }
    .boxA {
        margin: 2px 0px 2px 0px;
        border-width: 0px 2px 0px 2px;
    }
    .boxB {
        margin: 0px 0px 2px 0px;
        border-width: 2px 2px 0px 2px;
    }
    .boxC {
        margin: 2px 2px 0px 0px;
        border-width: 0px 0px 2px 2px;
    }
    .boxD {
        margin: 0px 2px 0px 0px;
        border-width: 2px 0px 2px 2px;
    }
    .boxE {
        margin: 2px 0px 0px 0px;
        border-width: 0px 2px 2px 2px;
    }
    .boxF {
        margin: 0px 0px 0px 0px;
        border-width: 2px 2px 2px 2px;
    }

    .nakami {
        display: table-cell;
        width: 36px;
        height: 36px;
        text-align: center;
        vertical-align: middle;
    }

    </style>

    <script type="text/javascript">
        var _mapdata, _xmax, _ymax, _ypos, _xpos, _muki;
        
        _mapdata = ['95555513',
        'A95553AA',
        'AAD53AAA',
        'AC556AAA',
        'C5515406',
        '93FAD3AB',
        'AAD452AA',
        'EC5556C6'];

        _ymax = 8;
        _xmax = 8;

        window.onload = function() {
            var x, xl, y, yl, c, div_map, kukaku, map, nakami, br;

            document.addEventListener('keydown', keyDownEvent);

            div_map = document.getElementById('div_map');

            for (y = 0, yl = _mapdata.length; y < yl; y++) {
                for (x = 0, xl = _mapdata[y].length; x < xl; x++) {
                    c = _mapdata[y].charAt(x);

                    kukaku = document.createElement('DIV');
                    kukaku.className = 'kukaku';

                    map = document.createElement('DIV');
                    map.id = 'map[' + x + '][' + y + ']';
                    map.className = 'box' + c;

                    nakami = document.createElement('DIV');
                    nakami.id = 'nakami[' + x + '][' + y + ']';
                    nakami.className = 'nakami';

                    map.appendChild(nakami);
                    kukaku.appendChild(map);
                    div_map.appendChild(kukaku);
                    
                }
                br = document.createElement('BR');
                div_map.appendChild(br);
            }

            _xpos = 0;
            _ypos = 7;
            _muki = 0;

            document.getElementById('nakami[' + _xpos + '][' + _ypos + ']').innerHTML = '↑';
        }

        function keyDownEvent(evt) {
            var keyCode, mukiArray, mukiArrayLengt, map, kabeChar, kabeType, xdiff, ydiff;

            keyCode = evt.keyCode;
            
            mukiArray = ['↑','→','↓','←'];
            mukiArrayLength = mukiArray.length;

            if (keyCode == '87') {
                map = document.getElementById('map[' + _xpos + '][' + _ypos + ']');
                kabeChar = map.className.replace(/box/, '');
                kabeType = parseInt(kabeChar, 16);

                xdiff = 0;
                ydiff = 0;
                if (_muki == 0) {
                    if ((kabeType & 1) == 0) {
                        ydiff = -1;
                    }
                } else if (_muki == 1) {
                    if ((kabeType & 2) == 0) {
                        xdiff = +1;
                    }
                } else if (_muki == 2) {
                    if ((kabeType & 4) == 0) {
                        ydiff = +1;
                    }
                } else if (_muki == 3) {
                    if ((kabeType & 8) == 0) {
                        xdiff = -1;
                    }
                }

                if (xdiff != 0 || ydiff != 0) {
                    document.getElementById('nakami[' + _xpos + '][' + _ypos + ']').innerHTML = '';
                    _xpos += xdiff;
                    _ypos += ydiff;
                    document.getElementById('nakami[' + _xpos + '][' + _ypos + ']').innerHTML = mukiArray[_muki];
                }

            } else if (keyCode == '65') {
                _muki--;
                if (_muki < 0) {
                    _muki = mukiArrayLength - 1;
                }
                document.getElementById('nakami[' + _xpos + '][' + _ypos + ']').innerHTML = mukiArray[_muki];

            } else if (keyCode == '68') {
                _muki++;
                if (mukiArrayLength - 1 < _muki) {
                    _muki = 0;
                }
                document.getElementById('nakami[' + _xpos + '][' + _ypos + ']').innerHTML = mukiArray[_muki];
            }

        }


    </script>
</head>

<body>
    <div id="div_map" class="map">
    </div>
</body>

</html>